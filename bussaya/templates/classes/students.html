{% extends '/admin/classes/index.html' %}
{% import '/base/error-handler.html' as eh %}
{% import '/admin/classes/project-renderer.html' as renderer %}
{% import '/navbar/class-navbar.html' as renderer_navbar %}

{% block breadcrumbs %}
<div class="ui breadcrumb">
    <a href="{{ url_for('admin.classes.index') }}" class="section">Classes</a>
    <div class="divider"> / </div>
    <a href="{{ url_for('admin.classes.view', class_id=class_.id) }}">{{ class_.name }}</a>
    <div class="divider"> / </div>
    <a href="{{ url_for('classes.view_students', class_id=class_.id) }}">View Students</a>
</div>
{% endblock %}


{% block content %}

{{ renderer_navbar.render_class_navbar(class_, current_user) }}

<h2 class="ui header">
    View Students
</h2>
<div class="ui divider"></div>

<table class="ui celled table">
  <thead>
    <th>No. </th>
    <th>Student Name</th>
    <th>Student ID</th>
    <th>Project</th>
    <th>Meetings</th>
    <th>Adivisor / Committees</th>
    <th>Group</th>
  </thead>
  <tbody>
    {% for student_id in class_.student_ids %}
      {% set student = get_student_by_id(student_id, students) %}
      {% if student %} 
        {% set project = student.get_project() %}
      {% endif %}
    <tr>
      <td>
        {{ loop.index }}
      </td>
      <td>
        {{ student_id }}
      </td>
      <td>
        {% if student %}
          {{ student.get_fullname() }}
        {% endif %}
      </td>
      <td>
        {% if project %}
          {{ project.name }}
        {% endif %}
      </td>
      <td>
        {% if student %}
          <div class="ui blue label">
            <i class="file icon"></i>
            {{ student.get_meeting_reports(class_, 'midterm').count() }} 
          </div>

          <div class="ui red label">
            <i class="file icon"></i>
            {{ student.get_meeting_reports(class_, 'final').count() }}
          </div>
        {% endif %}
      </td>
      <td>
        {% if project %}
          <b>{{ project.advisor.get_fullname() }}</b><br/>
          {% for c in project.committees %}
            {{ c.get_fullname() }}<br/>
          {% endfor %}
        {% endif %}
      </td>
      <td>
        {% if student %}
          {{ student.get_group(class_).name }}
        {% endif %}
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>



{% endblock %}
